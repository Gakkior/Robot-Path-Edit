# 🤖 机器人路径编辑器 - 需求文档

## 📋 核心需求

### 1. 基础定位
三端(Windows, Linux, Android)兼容的机器人点位和路径编辑器，用于设计、编辑和修改机器人的点位和路径等。

### 2. 数据库编辑功能 ✅
- **通用数据库编辑器**：支持选择任意表进行增删查改操作
- **Excel式编辑体验**：类似GoLand表格浏览器的美观流畅现代样式
- **灵活表结构支持**：无需固定表结构，适应性强

### 3. 可视化画布功能 ✅
- **数据关系可视化**：在画布上直观显示点位和路径的连接关系
- **灵活表映射**：
  - 指定点位表和路径表
  - 自定义唯一索引字段
  - 自定义路径起始点和终点字段
  - 其他字段任意，保证通用性
- **画布渲染**：构建点位间的连接关系图

### 4. 画布工具功能 ✅
- **Draw.io式画布**：专业的图形编辑体验
- **点位显示**：
  - 多种形状和大小表示
  - 默认圆形显示名称或ID
  - 可配置显示样式
- **路径连接**：
  - 直线或曲线连接
  - 双向/单向箭头表示方向性
- **样式自定义**：
  - 点位和路径的样式、大小、粗细、风格
  - 画布颜色、网格、缩放等
- **交互编辑**：
  - 鼠标/手指拖拽点位
  - 路径自动伸缩跟随
  - 点击显示属性面板
  - 六坐标值编辑支持
- **智能ID管理**：
  - 自定义或自增长唯一索引
  - 路径端点自动关联
  - 属性修改自动连接

### 5. 表格编辑功能 ✅
- **双视图支持**：画布视图 ↔ 表格视图无缝切换
- **实时同步**：两个界面修改实时同步
- **操作历史**：保存和撤回功能
- **安全机制**：修改先同步到内存，确认后保存到数据库

### 6. 界面设计要求 ✅
- **三端自适应**：自动调整大小适配不同设备
- **现代美观**：流畅丝滑的操作体验
- **酷炫交互**：精美的UI交互和Logo设计

## 🆕 新增功能需求

### 7. 数据导出功能 ✅ (2024.12 新增)
- **多格式导出**：支持Excel和CSV格式导出
- **UTF-8编码**：完美支持中文字符
- **分类导出**：
  - 单独导出点位表数据
  - 单独导出路径表数据  
  - 导出完整数据(包含两张表)
- **备份用途**：用于数据备份和迁移

### 8. 模板功能 ✅ (2024.12 新增)
- **布局模板**：保存常用的点位和路径布局范例
- **多种布局模式**：
  - 树形图布局
  - 网格布局
  - 圆形布局
  - 力导向布局
  - 管道布局
  - 层次布局
  - 径向布局
  - 自定义布局
- **模板管理**：
  - 创建和保存模板
  - 应用模板到画布
  - 模板分类和标签
  - 模板搜索和过滤
  - 模板克隆和导入导出
- **相对坐标系统**：模板使用相对位置，适应不同画布尺寸
- **使用统计**：跟踪模板使用频率

### 9. 数据库连接管理 ✅ (2024.11 新增)
- **多数据库支持**：SQLite、MySQL、PostgreSQL
- **连接配置管理**：创建、编辑、删除数据库连接
- **表映射配置**：灵活配置点位表和路径表字段映射
- **数据同步**：从外部数据库同步数据到编辑器

### 10. 撤销重做功能 ✅ (已实现)
- **命令模式**：基于命令模式的操作历史管理
- **快捷键支持**：Ctrl+Z撤销，Ctrl+Y重做
- **UI反馈**：撤销/重做按钮状态实时更新

## 🛠️ 技术实现

### 后端技术栈
- **语言**：Go 1.21+
- **框架**：Gin (HTTP路由)，GORM (ORM)
- **数据库**：SQLite, MySQL, PostgreSQL
- **架构模式**：领域驱动设计 (DDD)
- **设计模式**：仓储模式、命令模式、策略模式等

### 前端技术栈
- **画布引擎**：Konva.js (高性能2D Canvas)
- **语言**：原生JavaScript (轻量级)
- **UI样式**：现代CSS + HTML5
- **状态管理**：命令模式 (撤销/重做)

### 架构设计
```
┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐
│  Handler层    │   │  Service层    │   │Repository层   │
│ (HTTP接口)     │────│  (业务逻辑)    │────│  (数据访问)    │
└─────────────────┘   └─────────────────┘   └─────────────────┘
         │                      │                      │
┌─────────────────────────────────────────────────────────────────┐
│                    Domain层(核心领域模型)                      │
│    Node, Path, Template, DatabaseConnection, TableMapping     │
└─────────────────────────────────────────────────────────────────┘
```

## 🎯 实现状态

| 功能模块 | 状态 | 说明 |
|---------|------|------|
| 基础画布编辑 | ✅ 完成 | Konva.js实现，支持拖拽、连接等 |
| 表格编辑 | ✅ 完成 | 双视图切换，实时同步 |
| 数据库支持 | ✅ 完成 | SQLite、MySQL、PostgreSQL |
| 撤销重做 | ✅ 完成 | 命令模式，完整操作历史 |
| 布局算法 | ✅ 完成 | 网格、力导向、圆形等布局 |
| 路径生成 | ✅ 完成 | 最近邻、完全连通、网格路径 |
| 数据导出 | ✅ 完成 | Excel/CSV格式，UTF-8编码 |
| 模板功能 | ✅ 完成 | 8种布局类型，完整管理功能 |
| 数据库连接管理 | ✅ 完成 | 多数据库支持，灵活映射 |
| 三端支持 | 🔄 进行中 | Web端完成，桌面端和移动端待开发 |

## 🚀 未来规划

### 短期目标 (3个月内)
- [ ] **移动端优化**：触控交互优化，响应式设计
- [ ] **桌面端打包**：Electron或Tauri打包为桌面应用
- [ ] **在线模板库**：公共模板分享平台
- [ ] **实时协作**：多人同时编辑支持

### 中期目标 (6个月内)
- [ ] **机器人控制接口**：直接控制机器人执行路径
- [ ] **3D可视化**：支持3D场景和路径规划
- [ ] **AI路径优化**：智能路径优化算法
- [ ] **云端同步**：数据云端存储和同步

### 长期目标 (1年内)
- [ ] **VR/AR支持**：虚拟现实和增强现实界面
- [ ] **物理仿真**：路径执行物理仿真
- [ ] **多机器人协调**：多机器人协同路径规划
- [ ] **工业4.0集成**：与MES、ERP等系统集成

## 📚 学习价值

本项目采用了众多最佳实践和流行技术：
- **领域驱动设计 (DDD)**：清晰的业务领域建模
- **微服务架构思想**：模块化设计，高内聚低耦合
- **设计模式应用**：仓储、命令、策略、观察者等模式
- **现代Go开发**：标准项目结构，依赖注入，接口设计
- **前端工程化**：模块化JavaScript，性能优化
- **DevOps实践**：容器化部署，CI/CD，监控告警

## 🔧 技术亮点

- **高性能画布**：Konva.js支持万级节点流畅渲染
- **灵活数据映射**：支持任意表结构，无需固定schema
- **相对坐标系统**：模板适应不同画布尺寸
- **命令模式撤销**：完整的操作历史管理
- **UTF-8导出**：完美支持中文的数据导出
- **插件化架构**：可扩展的算法和功能插件系统


提示词：
我希望能够看这个项目怎么写的来学习，像是软件设计和架构等，参考这个软件的目的如果有更好的设计方案可以采用，你自己想要加一些其他功能也都行，我主要是想学很多的最佳实践，所以这个项目能够使用到的技术和设计等可以越全面越好，代码风格、设计、架构等可以越流行、越前沿越好，最好可以来自于某些优秀的、大型的流行项目中，且代码中给我详细的注释和阐述设计原因，如果能够标注来自于哪个项目或者哪些项目也使用了相似的设计就更好了，这个软件之后我也会继续拓展功能的，所以通用性、拓展性等也是需要的；
至于使用前后端分离还是一体式的软件怎么更好怎么来吧，后端用golang编写吧，直接写之前你如果有想问的或者让我选择的我们可以先讨论，然后你再生成一份需求文档或者todolist或者接口文档之类的我们再对一对，最后你就按照需求来做吧；






